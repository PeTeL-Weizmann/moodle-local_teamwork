{"version":3,"file":"init.min.js","sources":["../src/init.js"],"sourcesContent":["/* eslint-disable no-console */\n/* eslint-disable complexity */\n/* eslint-disable max-len */\n/* eslint-disable no-empty-function */\n/* eslint-disable no-unused-vars */\n/* eslint-disable camelcase */\ndefine([\n    'jquery',\n    'core/str',\n    'core/ajax',\n    'core/modal_factory',\n    'core/modal_events',\n    'local_teamwork/popup',\n    'local_teamwork/render',\n    'local_teamwork/dragula',\n    'local_teamwork/skin',\n    'local_teamwork/loading',\n    'local_teamwork/voicecontrol',\n    'local_teamwork/keyboardnav',\n    'core/notification',\n], function($, Str, Ajax, ModalFactory, ModalEvents, popup, render, drag, skin, loadingIcon, Voicecontrol, Keyboardnav, Notification) {\n    'use strict';\n\n    const mainBlock = document.querySelector('body');\n\n    var voice = false;\n\n    const set_teamwork_enable = (courseid, activityid, moduletype, callback) => {\n        Ajax.call([{\n            methodname: 'local_teamwork_set_teamwork_enable',\n            args: {\n                activityid: Number(activityid),\n                moduletype: moduletype,\n            },\n            done: function(data) {\n                callback(data);\n            },\n            fail: function() {\n                popup.error();\n            }\n        }]);\n    };\n\n    const set_access_to_student = (courseid, activityid, moduletype, target) => {\n        const access = target.checked;\n\n        Ajax.call([{\n            methodname: 'local_teamwork_set_access_to_student',\n            args: {\n                activityid: Number(activityid),\n                moduletype: moduletype,\n            },\n            done: function(data) {\n\n            },\n            fail: function() {\n                popup.error();\n            }\n        }]);\n    };\n\n    const add_new_card = (courseid, activityid, moduletype, selectgroupid, teamname = null, callback) => {\n\n        loadingIcon.show();\n        Ajax.call([{\n            methodname: 'local_teamwork_add_new_card',\n            args: {\n                courseid: Number(courseid),\n                activityid: Number(activityid),\n                moduletype: moduletype,\n                selectgroupid: selectgroupid,\n                teamname: teamname,\n            },\n            done: function(data) {\n                loadingIcon.remove();\n                callback(data);\n            },\n            fail: function() {\n                loadingIcon.remove();\n                popup.error();\n            }\n        }]);\n    };\n\n    const delete_card = (teamid, courseid, activityid, moduletype, callback) => {\n\n        loadingIcon.show();\n        Ajax.call([{\n            methodname: 'local_teamwork_delete_card',\n            args: {\n                teamid: teamid\n            },\n            done: function(data) {\n                loadingIcon.remove();\n                callback(data);\n            },\n            fail: function() {\n                loadingIcon.remove();\n                popup.error();\n            }\n        }]);\n    };\n\n    const delete_user_submit = (userid, teamid, courseid, activityid, moduletype, callback) => {\n\n        loadingIcon.show();\n        Ajax.call([{\n            methodname: 'local_teamwork_delete_user_submit',\n            args: {\n                userid: userid,\n                teamid: teamid,\n                courseid: Number(courseid),\n                activityid: Number(activityid),\n                moduletype: moduletype\n            },\n            done: function(data) {\n                loadingIcon.remove();\n                callback(data);\n            },\n            fail: function() {\n                loadingIcon.remove();\n                popup.error();\n            }\n        }]);\n    };\n\n    const show_random_popup = () => {\n        Ajax.call([{\n            methodname: 'local_teamwork_show_random_popup',\n            args: {},\n            done: function(data) {\n                let result = JSON.parse(data.result);\n                popup.textHead = result.header;\n                popup.text = result.content;\n                popup.show();\n                Keyboardnav.getFocusableElements('.teamwork-modal');\n                Keyboardnav.setAccessabilityBehaviuor();\n                Keyboardnav.setFocusOnElement('#student_number');\n            },\n            fail: function() {\n                popup.error();\n            }\n        }]);\n    };\n\n    /* Toggle actions on allow enddate checkbox status change in student settings popup */\n    const student_settings_enddate_state = () => {\n        const teamuserallowenddatechkbox = document.querySelector(\"#teamuserallowenddate\");\n        const allinputs = Array.from(\n            document.querySelectorAll(\".teamuserenddate-inputs-wrapper input, .teamuserenddate-inputs-wrapper select\")\n        );\n        teamuserallowenddatechkbox.addEventListener(\"change\", e => {\n            if (e.target.checked) {\n                allinputs.forEach(item => {\n                    item.removeAttribute(\"disabled\");\n                });\n                e.target.value = \"1\";\n            } else {\n                allinputs.forEach(item => {\n                    item.setAttribute(\"disabled\", \"disabled\");\n                });\n                e.target.value = \"0\";\n            }\n            Keyboardnav.getFocusableElements('.teamwork-modal');\n            Keyboardnav.setAccessabilityBehaviuor();\n        });\n    };\n\n    /* Render_student_settings_popup */\n    const render_student_settings_popup = (activityid, moduletype) => {\n        Ajax.call([{\n            methodname: 'local_teamwork_render_student_settings_popup',\n            args: {\n                activityid: activityid,\n                moduletype: moduletype\n            },\n            done: function(data) {\n                let result = JSON.parse(data.result);\n                popup.textHead = result.header;\n                popup.text = result.content;\n                popup.show();\n\n                Keyboardnav.getFocusableElements('.teamwork-modal');\n                Keyboardnav.setAccessabilityBehaviuor();\n                Keyboardnav.setFocusOnElement('#teamnumbers');\n                setTimeout(student_settings_enddate_state, 1000);\n            },\n            fail: function() {\n                popup.error();\n            }\n        }]);\n    };\n\n    const student_settings_popup_data = (courseid, activityid, moduletype) => {\n        const popupForm = document.querySelector(\".teamwork-modal\");\n        const teamNumbers = popupForm.querySelector('#teamnumbers').value;\n        const teamUserNumbers = popupForm.querySelector('#teamusernumbers').value;\n        const teamUserendDate = popupForm.querySelector(\n            \"input[name=team-userend-date]\"\n        ).value;\n        const teamUserendMonth = popupForm.querySelector(\n            \"select[name=team-userend-month]\"\n        ).value;\n        const teamUserendYear = popupForm.querySelector(\n            \"input[name=team-userend-year]\"\n        ).value;\n        const teamUserendHour = popupForm.querySelector(\n            \"input[name=team-userend-hour]\"\n        ).value;\n        const teamUserendMinute = popupForm.querySelector(\n            \"input[name=team-userend-minute]\"\n        ).value;\n        const teamuserallowenddate = popupForm.querySelector(\n            \"input[name=teamuserallowenddate]\"\n        ).value;\n\n        loadingIcon.show();\n        Ajax.call([{\n            methodname: 'local_teamwork_student_settings_popup_data',\n            args: {\n                courseid: Number(courseid),\n                activityid: Number(activityid),\n                moduletype: moduletype,\n                teamnumbers: Number(teamNumbers),\n                teamusernumbers: Number(teamUserNumbers),\n                teamuserenddate: Number(teamUserendDate),\n                teamuserendmonth: Number(teamUserendMonth),\n                teamuserendyear: Number(teamUserendYear),\n                teamuserendhour: Number(teamUserendHour),\n                teamuserendminute: Number(teamUserendMinute),\n                teamuserallowenddate: Number(teamuserallowenddate),\n            },\n            done: function(data) {\n                loadingIcon.remove();\n            },\n            fail: function() {\n                popup.error();\n            }\n        }]);\n    };\n\n    const set_random_teams = (target, courseid, activityid, moduletype, selectgroupid, callback) => {\n        while (!target.classList.contains('teamwork-modal')) {\n            target = target.parentNode;\n        }\n        const numberofstudent = target.querySelector('#student_number').value;\n\n        loadingIcon.show();\n        Ajax.call([{\n            methodname: 'local_teamwork_set_random_teams',\n            args: {\n                courseid: Number(courseid),\n                activityid: Number(activityid),\n                moduletype: moduletype,\n                selectgroupid: selectgroupid,\n                numberofstudent: Number(numberofstudent),\n            },\n            done: function(data) {\n                loadingIcon.remove();\n                callback(data);\n            },\n            fail: function() {\n                loadingIcon.remove();\n                popup.error();\n            }\n        }]);\n    };\n\n    const set_new_team_name = (target, courseid, activityid, moduletype, selectgroupid, callback) => {\n        const cardid = target.dataset.team_id;\n        const cardname = target.value;\n\n        Ajax.call([{\n            methodname: 'local_teamwork_set_new_team_name',\n            args: {\n                cardid: Number(cardid),\n                cardname: cardname,\n            },\n            done: function(data) {\n                callback();\n            },\n            fail: function() {\n                popup.error();\n            }\n        }]);\n    };\n\n    // Search student by name on student list.\n    const searchStudentByName = target => {\n        const studentList = Array.from(\n            document.querySelectorAll(\"#studentList div[data-student_id]\")\n        );\n        const hiddenClass = 'visuallyhidden';\n        const searchItem = target.value;\n    if (!searchItem) {\n        studentList.forEach(item => {\n            item.classList.remove(hiddenClass);\n        });\n        return;\n    }\n\n        studentList.forEach(item => {\n            if (item.innerHTML.toLowerCase().search(searchItem.toLowerCase()) >= 0) {\n                item.classList.remove(hiddenClass);\n            } else {\n                item.classList.add(hiddenClass);\n            }\n        });\n    };\n\n    const searchInit = () => {\n        // Init search for student list.\n        const searchInput = mainBlock.querySelector(\n            'input[data-handler = \"search_student\"]'\n        );\n        searchInput.addEventListener(\"input\", function(e) {\n            searchStudentByName(searchInput);\n        });\n    };\n\n    const searchReset = target => {\n        const studentList = Array.from(\n            document.querySelectorAll(\"#studentList div[data-student_id]\")\n        );\n        const hiddenClass = 'visuallyhidden';\n        const searchInput = mainBlock.querySelector(\n            'input[data-handler = \"search_student\"]'\n        );\n\n        searchInput.value = '';\n        studentList.forEach(item => {\n            item.classList.remove(hiddenClass);\n        });\n    };\n\n    return {\n\n        // For voicerecognition.\n        add_new_card: function(courseid, activityid, moduletype, selectgroupid, teamname, callback) {\n            add_new_card(courseid, activityid, moduletype, selectgroupid, teamname, callback);\n        },\n        delete_card: function(teamid, courseid, activityid, moduletype, callback) {\n            delete_card(teamid, courseid, activityid, moduletype, callback);\n        },\n\n        init: function(courseid, activityid, moduletype, selectgroupid) {\n\n            let self = this;\n            let voice = 0;\n\n            Ajax.call([{\n                methodname: 'local_teamwork_render_block_html_page',\n                args: {\n                    courseid: Number(courseid),\n                    activityid: Number(activityid),\n                    moduletype: moduletype,\n                    selectgroupid: selectgroupid\n                },\n                done: function(data) {\n\n                    let paths = JSON.parse(data.paths);\n                    let tokens = JSON.parse(data.tokens);\n                    let schemes = JSON.parse(data.schemes);\n\n                    voice = data.voicecontrolenabled;\n                    if (voice !== 0) {\n                        Voicecontrol.init(data.currentlangcode, paths, tokens, schemes);\n                        Voicecontrol.reload(courseid, activityid, moduletype, selectgroupid, paths, data.currentlangcode);\n                    }\n\n                    if (moduletype === 'assign') {\n                        let assign = $(\"body#page-mod-assign-view #intro\");\n                        assign.append(data.html);\n                        self.renderHtmlToPage(courseid, activityid, moduletype, selectgroupid);\n                    }\n\n                    if (moduletype === 'quiz') {\n                        let quiz = $(\".quizinfo\");\n                        quiz.append(data.html);\n                        self.renderHtmlToPage(courseid, activityid, moduletype, selectgroupid);\n                    }\n                },\n                fail: Notification.exception\n            }]);\n\n        },\n\n        renderHtmlToPage: function(courseid, activityid, moduletype, selectgroupid) {\n            render.data = {\n                sesskey: M.cfg.sesskey,\n                courseid: courseid,\n                activityid: activityid,\n                moduletype: moduletype,\n                selectgroupid: selectgroupid\n            };\n\n            // Run and open local window.\n            $(\"#open_local\").on(\"click\", function() {\n                render.mainBlock(searchInit, voice);\n            });\n\n            document.addEventListener('click', function(event) {\n                let target = event.target;\n                event.stopPropagation();\n                while (target !== mainBlock) {\n                    // Activate/diactivate teamwork.\n                    if (target.dataset.handler === 'teamwork_toggle') {\n                        target.classList.toggle('active');\n                        let state = target.dataset.state === 'active' ? 'disabled' : 'active';\n                        target.dataset.state = state;\n                        target.setAttribute('aria-pressed', state);\n                        $(\".skin_shadow\").toggleClass(\"skin_show\").toggleClass(\"skin_hide\");\n\n                        skin.checkPopupSkinState(state);\n                        if(state === 'disabled') {\n                            Keyboardnav.getFocusableElements('.teamworkdialog', '[data-handler=\"teamwork_toggle\"], .skin_close');\n                        } else {\n                            Keyboardnav.getFocusableElements('.teamworkdialog');\n                        }\n                        Keyboardnav.setFocusOnElement('[data-handler=\"teamwork_toggle\"]');\n                        Keyboardnav.setAccessabilityBehaviuor();\n                        set_teamwork_enable(courseid, activityid, moduletype, function() {});\n                        return;\n                    }\n\n                    // Close popups.\n                    if (target.classList.contains('close_popup') || target.classList.contains('teamwork-modal_close')) {\n                        if (target.classList.contains('stop-close')) {\n                            return;\n                        }\n                        popup.remove();\n                        if (target.classList.contains('teamwork-modal_close')) {\n                            Keyboardnav.getFocusableElements('.teamworkdialog');\n                            Keyboardnav.setAccessabilityBehaviuor();\n                            Keyboardnav.setFocusOnPrevfocusedElement();\n                            return;\n                        }\n                        return;\n                    }\n\n\n                    // Close skin popup.\n                    if (target.classList.contains('skin_close') || target.classList.contains('close_btn')) {\n                        if (voice !== 0) {\n                            Voicecontrol.stop();\n                        }\n                        skin.remove();\n                        return;\n                    }\n\n                    // Show student_setting popup.\n                    if (target.dataset.handler === 'access_to_student') {\n                        if (target.classList.contains('active')) {\n                            target.classList.remove('active');\n                            set_access_to_student(courseid, activityid, moduletype, target);\n                        } else {\n                            target.classList.add('active');\n                            render_student_settings_popup(activityid, moduletype);\n                            Keyboardnav.setPrevfocusedElement(`[data-handler=\"${target.dataset.handler}\"]`);\n                            set_access_to_student(courseid, activityid, moduletype, target);\n                        }\n                    }\n\n                    // Delete user submit.\n                    if (target.dataset.handler === 'delete_user_submit') {\n                        let userid = target.dataset.userid;\n                        let teamid = target.dataset.teamid;\n                        Keyboardnav.setPrevfocusedElement(`[data-userid=\"${userid}\"]`);\n\n                        Str.get_strings([\n                            {key: 'titlepopupremoveuser', component: 'local_teamwork'},\n                            {key: 'contentpopupremoveuser', component: 'local_teamwork'},\n                            {key: 'buttonpopupremoveuser', component: 'local_teamwork'},\n                        ]).done(function(strings) {\n                            var modalPromise = ModalFactory.create({\n                                type: ModalFactory.types.SAVE_CANCEL,\n                                title: strings[0],\n                                body: strings[1]\n                            });\n\n                            $.when(modalPromise).then(function(fmodal) {\n\n                                fmodal.setSaveButtonText(strings[2]);\n\n                                // Handle save event.\n                                fmodal.getRoot().on(ModalEvents.save, function(e) {\n                                    e.preventDefault();\n\n                                    delete_user_submit(userid, teamid, courseid, activityid, moduletype, function() {\n                                        render.setDefaultData();\n                                        render.studentList();\n                                        render.teamsCard();\n                                        $('.skin.shadow').removeAttr(\"style\");\n                                        fmodal.destroy();\n                                    });\n                                });\n                                fmodal.getRoot().on(ModalEvents.cancel, function(e) {\n                                    $('.skin.shadow').removeAttr(\"style\");\n                                    fmodal.destroy();\n                                    Keyboardnav.setFocusOnPrevfocusedElement();\n                                    console.log('cancel');\n                                });\n\n                                var root = fmodal.getRoot();\n                                root.on(ModalEvents.shown, function() {\n                                    $('.skin.shadow').css(\"z-index\", \"1000\");\n                                });\n\n                              /*   root.on(ModalEvents.hidden, function() {\n                                    console.log('hidfeded');\n                                    $('.skin.shadow').removeAttr(\"style\");\n                                    fmodal.destroy();\n                                }); */\n\n                                return fmodal;\n                            }).done(function(modal) {\n                                modal.show();\n                            }).fail(Notification.exception);\n                        });\n\n                        return;\n                    }\n\n                    // Get data from popup form.\n                    if (target.dataset.handler === 'get_popup_data') {\n                        console.log(event.type);\n                        event.preventDefault();\n                        student_settings_popup_data(courseid, activityid, moduletype);\n                        popup.remove();\n                        Keyboardnav.getFocusableElements('.teamworkdialog');\n                        Keyboardnav.setAccessabilityBehaviuor();\n                        Keyboardnav.setFocusOnPrevfocusedElement();\n                        return;\n                    }\n\n                    // Open select group menu.\n                    if (target.dataset.handler === 'open_group_selection') {\n                        $(target)\n                            .next()\n                            .slideToggle();\n                        return;\n                    }\n\n                    // Handle select group.\n                    if (target.dataset.handler === 'select_groups') {\n                        let text = document.querySelector('html[lang=\"en\"]')\n                            ? \"choose grous\"\n                            : \"בחר קבוצה\";\n                        if (target.classList.contains('selected')) {\n                            return;\n                        }\n                        target.classList.toggle('selected');\n                        $('div[data-handler=\"open_group_selection\"]').html(\n                            target.classList.contains('selected') ? target.innerHTML : text\n                        );\n\n                        $(target).siblings().removeClass(\"selected\");\n\n                        let result = [];\n                        let val = Array.from(target.parentNode.children);\n                        val.forEach(item => {\n                            if (item.classList.contains('selected')) {\n                                result.push(item.dataset.value);\n                            }\n                        });\n                        $(target)\n                            .parent()\n                            .slideToggle();\n                        selectgroupid = JSON.stringify(result);\n                        render.data.selectgroupid = JSON.stringify(result);\n                        render.studentList();\n                        render.teamsCard();\n                        return;\n                    }\n\n                    // Add new team card.\n                    if (target.dataset.handler === 'add_new_teamcard') {\n                        add_new_card(\n                            courseid,\n                            activityid,\n                            moduletype,\n                            selectgroupid,\n                            null,\n                            function() {\n                                render.setDefaultData();\n                                render.studentList();\n                                render.teamsCard();\n                            }\n                        );\n\n                        return;\n                    }\n\n                    // Delete team card.\n                    if (target.dataset.handler === 'delete_teamcard') {\n                        let teamid = target.dataset.remove_team_id;\n                        delete_card(teamid, courseid, activityid, moduletype, function() {\n                            render.setDefaultData();\n                            render.teamsCard();\n                            render.studentList();\n                        });\n                        Keyboardnav.setPrevfocusedElement(`[data-handler=\"${target.dataset.handler}\"]`);\n\n                        return;\n                    }\n\n                    // Show popup to determine the random number of students on the each team.\n                    if (target.dataset.handler === 'random_popup') {\n                        show_random_popup();\n                        Keyboardnav.setPrevfocusedElement(`[data-handler=\"${target.dataset.handler}\"]`);\n                        return;\n                    }\n\n                    // Set random teams.\n                    if (target.dataset.handler === 'random') {\n                        set_random_teams(\n                            target,\n                            courseid,\n                            activityid,\n                            moduletype,\n                            render.data.selectgroupid,\n                            function() {\n                                render.teamsCard();\n                                render.studentList();\n                                popup.remove();\n//FIXME:\n                         /*        skin.getFocusableElements($('.teamworkdialog'));\n                                skin.setAccessabilityBehaviuor(); */\n                                // skin.setFocusOnElement(skin.PREVFOCUSED.element);\n                            }\n                        );\n                        return;\n                    }\n\n                    // Search reset.\n                    if (target.dataset.handler === 'search_reset') {\n                        searchReset(target);\n                        return;\n                    }\n\n                    target = target.parentNode;\n                }\n            });\n\n            // Close popup by keypres on close X btn\n            $(document).on(\"keydown\", \".skin_close\", function(e) {\n                let keycode = (e.keyCode ? e.keyCode : e.which);\n                if (keycode === 13) {\n                    if (voice !== 0) {\n                        Voicecontrol.stop();\n                    }\n                    skin.remove();\n                }\n            });\n\n\n            // Init drug and drop events.\n            drag.startDrag();\n\n            // Change team name.\n            document.addEventListener(\"change\", function(event) {\n                if (event.target.dataset.handler === 'input_team_name') {\n                    set_new_team_name(\n                        event.target,\n                        courseid,\n                        activityid,\n                        moduletype,\n                        render.data.selectgroupid,\n                        function() {\n                            render.teamsCard();\n                        }\n                    );\n                    Keyboardnav.setPrevfocusedElement(`[data-handler=\"${event.target.dataset.handler}\"]`);\n                }\n            });\n\n            // Change team name with keypress.\n            document.addEventListener(\"keypress\", function(event) {\n                if (event.target.dataset.handler === 'input_team_name' && event.keyCode === 13) {\n                    set_new_team_name(\n                        event.target,\n                        courseid,\n                        activityid,\n                        moduletype,\n                        render.data.selectgroupid,\n                        function() {\n                            render.teamsCard();\n                        }\n                    );\n                }\n            });\n\n            // Close all popups by esc.\n            document.addEventListener(\"keydown\", function(event) {\n                if (event.keyCode === 27) {\n                    skin.remove();\n                    popup.remove();\n                }\n            });\n\n        }\n    };\n});\n"],"names":["define","$","Str","Ajax","ModalFactory","ModalEvents","popup","render","drag","skin","loadingIcon","Voicecontrol","Keyboardnav","Notification","mainBlock","document","querySelector","set_teamwork_enable","courseid","activityid","moduletype","callback","call","methodname","args","Number","done","data","fail","error","set_access_to_student","target","checked","add_new_card","selectgroupid","teamname","show","remove","delete_card","teamid","delete_user_submit","userid","student_settings_enddate_state","teamuserallowenddatechkbox","allinputs","Array","from","querySelectorAll","addEventListener","e","forEach","item","removeAttribute","value","setAttribute","getFocusableElements","setAccessabilityBehaviuor","render_student_settings_popup","result","JSON","parse","textHead","header","text","content","setFocusOnElement","setTimeout","student_settings_popup_data","popupForm","teamNumbers","teamUserNumbers","teamUserendDate","teamUserendMonth","teamUserendYear","teamUserendHour","teamUserendMinute","teamuserallowenddate","teamnumbers","teamusernumbers","teamuserenddate","teamuserendmonth","teamuserendyear","teamuserendhour","teamuserendminute","set_random_teams","classList","contains","parentNode","numberofstudent","set_new_team_name","cardid","dataset","team_id","cardname","searchInit","searchInput","studentList","searchItem","innerHTML","toLowerCase","search","add","init","self","this","paths","tokens","schemes","voicecontrolenabled","currentlangcode","reload","append","html","renderHtmlToPage","exception","sesskey","M","cfg","on","event","stopPropagation","handler","toggle","state","toggleClass","checkPopupSkinState","setFocusOnPrevfocusedElement","stop","setPrevfocusedElement","get_strings","key","component","strings","modalPromise","create","type","types","SAVE_CANCEL","title","body","when","then","fmodal","setSaveButtonText","getRoot","save","preventDefault","setDefaultData","teamsCard","removeAttr","destroy","cancel","console","log","shown","css","modal","next","slideToggle","siblings","removeClass","children","push","parent","stringify","remove_team_id","keyCode","which","startDrag"],"mappings":"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"}