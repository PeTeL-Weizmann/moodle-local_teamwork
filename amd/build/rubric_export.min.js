/**
 * Javascript to initialise the myoverview block.
 *
 * @package    local_teamwork
 * @copyright  2018 Bas Brands <bas@moodle.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_teamwork/rubric_export",["jquery","core/str","core/ajax","core/notification"],(function($,Str,Ajax,Notification){return{selector:{wrapper:"#rubric-advancedgrading",wrapper_error:"#id_error_advancedgrading",button:"#save-rubrics"},init:function(userid,callback){var queryDict={};if(location.search.substr(1).split("&").forEach((function(item){queryDict[item.split("=")[0]]=item.split("=")[1]})),0!==queryDict.id.length&&0!==queryDict.action.length&&"grader"===queryDict.action){var assignid=queryDict.id,rubricsave_notice="";Str.get_string("rubricsave_notice","local_teamwork").done((function(translation){rubricsave_notice=translation}));var button_name="";Str.get_string("rubricsave","local_teamwork").done((function(translation){button_name=translation}));var self=this;this.waitForElement(this.selector.wrapper,(function(){$('<span></span><a id="save-rubrics" class="btn btn-primary mt-10" style="color:white;font-weight: bold;">'+button_name+"</a>"+rubricsave_notice+"</span>").insertAfter(self.selector.wrapper),$(self.selector.button).on("click",(function(e){$(e.target);var element=window.document.getElementsByClassName("gradingform_rubric")[0],width=element.offsetWidth;width*=1.875;self.loadingPage(),require(["local_teamwork/html2pdf_bundle"],(function(html2pdf){html2pdf().from(element).set({margin:1,filename:"test.pdf",html2canvas:{scale:2},jsPDF:{orientation:"portrait",unit:"pt",format:[width,841.89],compressPDF:!0}}).outputPdf().then((function(pdf){Ajax.call([{methodname:"local_teamwork_save_rubrics_pdf",args:{assignid:Number(assignid),userid:Number(userid),content:btoa(pdf)},done:function(){callback()},fail:Notification.exception}])}))}))}))}))}},waitForElement:function(elementPath,callBack){var self=this;window.setTimeout((function(){$(elementPath).length?callBack(elementPath,$(elementPath)):self.waitForElement(elementPath,callBack)}),500)},loadingPage:function(){var shadow=$('<div class = "loading" style="display: flex; position: fixed; z-index: 99999; top: 0; bottom: 0; right: 0; left: 0; background: #0000006b;"><div class = "spinner" style = "margin: auto;width: 6rem;height: 6rem;border: .6em solid #fff;border-right-color: transparent;border-radius: 50%;animation: spinner-border .75s linear infinite;"></div></div>');$("body").append(shadow)}}}));

//# sourceMappingURL=rubric_export.min.js.map