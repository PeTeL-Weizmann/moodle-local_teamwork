define ("local_teamwork/dragula",["core/ajax","local_teamwork/render","local_teamwork/popup","local_teamwork/loading","local_teamwork/dragulasource"],function(a,b,c,d,e){'use strict';var f=function(e,f){var g=Array.from(document.querySelectorAll("div[data-team_id]")),h=[],i=e.dataset.student_id;g.forEach(function(a){var b={teamid:a.dataset.team_id,studentid:[]},c=Array.from(a.querySelectorAll(".teamwork_student"));c.forEach(function(a){b.studentid.push(a.dataset.student_id)});h.push(b)});d.show();a.call([{methodname:"local_teamwork_drag_student_card",args:{courseid:+b.data.courseid,activityid:+b.data.activityid,moduletype:b.data.moduletype,selectgroupid:b.data.selectgroupid,newteamspost:JSON.stringify(h),draguserid:+i},done:function done(a){d.remove();f(a)},fail:function fail(){d.remove();c.error()}}])},g=function(a,c,d){var e=d.dataset.max_count;if(c.childElementCount===e){c.classList.add("stop-drag")}if(d.childElementCount<e){d.classList.remove("stop-drag")}f(a,function(){b.setDefaultData();b.studentList();b.teamsCard()})};return{startDrag:function startDrag(){e({isContainer:function isContainer(a){return a.classList.contains("draggable")},accepts:function accepts(a,b){if(!b.classList.contains("stop-drag")){return b}},invalid:function invalid(a){if(a.classList.contains("stop-drag-item")){return!0}}}).on("drop",g)}}});
//# sourceMappingURL=dragula.min.js.map
